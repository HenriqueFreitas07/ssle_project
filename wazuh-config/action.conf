<!-- Active Response for DoS Attack Mitigation -->

<!-- Block source IP for general DoS attacks (200101) -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200101</rules_id>
  <timeout>600</timeout>
</active-response>

<!-- Block source IP for Apache HTTP flood attacks (200122) -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200122</rules_id>
  <timeout>1800</timeout>
</active-response>

<!-- Block source IP for SYN flood attacks (200131) -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200131</rules_id>
  <timeout>900</timeout>
</active-response>

<!-- Additional response: Add to hosts.deny for persistent blocking -->
<active-response>
  <command>host-deny</command>
  <location>local</location>
  <rules_id>200122,200131</rules_id>
  <timeout>3600</timeout>
</active-response>

<!-- Optional: Route attacker traffic to null for severe attacks -->
<active-response>
  <command>route-null</command>
  <location>local</location>
  <rules_id>200131</rules_id>
  <timeout>1200</timeout>
</active-response>


<!-- Block IPs making repeated connections from same source -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200140</rules_id>
  <timeout>1200</timeout>
</active-response>

<!-- Block during high Apache error rates -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200151</rules_id>
  <timeout>600</timeout>
</active-response>

<!-- Block UDP floods -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200161</rules_id>
  <timeout>900</timeout>
</active-response>

<!-- Block slowloris attacks -->
<active-response>
  <command>firewall-drop</command>
  <location>local</location>
  <rules_id>200170</rules_id>
  <timeout>1800</timeout>
</active-response>
